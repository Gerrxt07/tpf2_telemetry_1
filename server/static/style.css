/*
 * TPF2 Real-Time Telemetry – Custom CSS
 * Tailwind CDN handles layout & structure (index.html).
 * This file covers only elements injected dynamically via JavaScript,
 * plus small overrides that Tailwind cannot express at runtime.
 */

/* ── Connection dot ─────────────────────────────────────────────────── */
#conn-dot {
  background-color: #94a3b8;
  transition: background-color 0.3s, box-shadow 0.3s;
}
#conn-dot.connected    { background-color: #22c55e; box-shadow: 0 0 0 3px rgba(34,197,94,.2); }
#conn-dot.disconnected { background-color: #ef4444; }
#conn-dot.connecting   { background-color: #f59e0b; animation: pulse-dot 1s infinite; }

@keyframes pulse-dot { 0%,100% { opacity:1 } 50% { opacity:.3 } }

/* ── Column filter inputs ───────────────────────────────────────────── */
.col-filter-input {
  width: 100%;
  padding: .2rem .45rem;
  font-size: .72rem;
  border-radius: .375rem;
  border: 1px solid #334155;
  background: #1e293b;
  color: #e2e8f0;
  outline: none;
}
.col-filter-input::placeholder { color: #64748b; }
.col-filter-input:focus { border-color: #3b82f6; }

html:not(.dark) .col-filter-input {
  border-color: #e2e8f0;
  background: #fff;
  color: #1e293b;
}
html:not(.dark) .col-filter-input::placeholder { color: #94a3b8; }

/* ── Filter pills ───────────────────────────────────────────────────── */
.pill          { cursor: pointer; user-select: none; color: #64748b;  border-color: #334155; }
.pill:hover    { border-color: #3b82f6; color: #cbd5e1; }
.pill.active   { background: rgba(59,130,246,.18); border-color: #3b82f6; color: #93c5fd; }

html:not(.dark) .pill        { color: #64748b;  border-color: #e2e8f0; }
html:not(.dark) .pill:hover  { border-color: #3b82f6; color: #1e293b; }
html:not(.dark) .pill.active { background: rgba(59,130,246,.1); border-color: #3b82f6; color: #2563eb; }

/* ── Type badges (injected via innerHTML) ───────────────────────────── */
.type-badge {
  display: inline-flex; align-items: center;
  padding: .18rem .55rem; border-radius: 9999px;
  font-size: .7rem; font-weight: 600; letter-spacing: .03em; white-space: nowrap;
}
.type-RAIL    { background:rgba(59,130,246,.14); color:#60a5fa }
.type-ROAD    { background:rgba(34,197,94,.14);  color:#4ade80 }
.type-TRAM    { background:rgba(245,158,11,.14); color:#fbbf24 }
.type-WATER   { background:rgba(6,182,212,.14);  color:#22d3ee }
.type-AIR     { background:rgba(168,85,247,.14); color:#c084fc }
.type-UNKNOWN { background:rgba(148,163,184,.1); color:#94a3b8 }

html:not(.dark) .type-RAIL    { background:rgba(59,130,246,.1);  color:#2563eb }
html:not(.dark) .type-ROAD    { background:rgba(34,197,94,.1);   color:#16a34a }
html:not(.dark) .type-TRAM    { background:rgba(245,158,11,.1);  color:#d97706 }
html:not(.dark) .type-WATER   { background:rgba(6,182,212,.1);   color:#0891b2 }
html:not(.dark) .type-AIR     { background:rgba(168,85,247,.1);  color:#7c3aed }
html:not(.dark) .type-UNKNOWN { background:rgba(148,163,184,.08);color:#64748b }

/* ── State badges (injected via innerHTML) ──────────────────────────── */
.state-badge {
  display: inline-flex; align-items: center; gap: .3rem;
  padding: .18rem .55rem; border-radius: 9999px;
  font-size: .7rem; font-weight: 600; border: 1px solid transparent;
}
.state-badge::before {
  content: ""; width: 5px; height: 5px;
  border-radius: 50%; background: currentColor; flex-shrink: 0;
}
.state-moving  { background:rgba(34,197,94,.12);   color:#4ade80; border-color:rgba(34,197,94,.3);   }
.state-stop    { background:rgba(245,158,11,.12);  color:#fbbf24; border-color:rgba(245,158,11,.3);  }
.state-service { background:rgba(59,130,246,.12);  color:#60a5fa; border-color:rgba(59,130,246,.3);  }
.state-idle    { background:rgba(168,85,247,.12);  color:#c084fc; border-color:rgba(168,85,247,.3);  }
.state-stopped { background:rgba(239,68,68,.12);   color:#f87171; border-color:rgba(239,68,68,.3);   }
.state-unknown { background:rgba(148,163,184,.1);  color:#94a3b8; border-color:rgba(148,163,184,.2); }

html:not(.dark) .state-moving  { color:#16a34a; background:rgba(34,197,94,.1);   border-color:rgba(22,163,74,.25);   }
html:not(.dark) .state-stop    { color:#d97706; background:rgba(245,158,11,.1);  border-color:rgba(217,119,6,.25);   }
html:not(.dark) .state-service { color:#2563eb; background:rgba(59,130,246,.1);  border-color:rgba(37,99,235,.25);   }
html:not(.dark) .state-idle    { color:#7c3aed; background:rgba(168,85,247,.1);  border-color:rgba(124,58,237,.25);  }
html:not(.dark) .state-stopped { color:#dc2626; background:rgba(239,68,68,.1);   border-color:rgba(220,38,38,.25);   }
html:not(.dark) .state-unknown { color:#64748b; background:rgba(148,163,184,.08);border-color:rgba(100,116,139,.2);  }

/* ── View tabs + map ─────────────────────────────────────────────────── */
.view-tab {
  padding: 0.55rem 1rem;
  border-radius: 0.75rem;
  border: 1px solid #334155;
  background: #0f172a;
  color: #e2e8f0;
  font-weight: 600;
  font-size: .9rem;
  transition: all .2s ease;
}
.view-tab:hover { border-color: #3b82f6; color: #bfdbfe; }
.view-tab.active { background: #1d4ed8; border-color: #3b82f6; color: #fff; box-shadow: 0 8px 20px rgba(59,130,246,.25); }
html:not(.dark) .view-tab { background: #fff; color: #1e293b; border-color: #e2e8f0; }
html:not(.dark) .view-tab:hover { color: #1d4ed8; border-color: #3b82f6; }
html:not(.dark) .view-tab.active { background: #1d4ed8; color: #fff; }

.map-container {
  position: relative;
  height: calc(100vh - 200px);
  min-height: 420px;
  background: #1e1e1e;
}
#telemetryMap {
  width: 100%;
  height: 100%;
  display: block;
  background: #1e1e1e;
  cursor: grab;
  touch-action: none;
}
#telemetryMap.dragging { cursor: grabbing; }
#telemetryMap.hovering { cursor: pointer; }

.map-toolbar {
  position: absolute;
  z-index: 3;
  top: 10px;
  left: 10px;
  right: 10px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 10px;
  pointer-events: none;
}
.map-toolbar-left,
.map-toolbar-right {
  display: flex;
  align-items: center;
  gap: 8px;
  pointer-events: auto;
}
.map-btn {
  border: 1px solid rgba(148,163,184,.35);
  background: rgba(15,23,42,.85);
  color: #e2e8f0;
  font-size: .78rem;
  font-weight: 600;
  border-radius: .55rem;
  padding: .35rem .6rem;
}
.map-btn:hover { border-color: #60a5fa; color: #bfdbfe; }

.map-toggle {
  display: inline-flex;
  align-items: center;
  gap: .3rem;
  border: 1px solid rgba(148,163,184,.25);
  background: rgba(15,23,42,.72);
  color: #cbd5e1;
  font-size: .74rem;
  border-radius: .55rem;
  padding: .2rem .45rem;
  user-select: none;
}
.map-toggle input { accent-color: #3b82f6; }

.map-tooltip {
  position: absolute;
  z-index: 4;
  pointer-events: none;
  max-width: 260px;
  background: rgba(15,23,42,.95);
  color: #e2e8f0;
  border: 1px solid rgba(148,163,184,.35);
  border-radius: .55rem;
  font-size: .74rem;
  line-height: 1.35;
  padding: .35rem .5rem;
  box-shadow: 0 8px 26px rgba(0,0,0,.35);
}
.map-tooltip.hidden { display: none; }

/* ── Speed cells ────────────────────────────────────────────────────── */
.speed-cell   { font-variant-numeric:tabular-nums; font-weight:600; font-size:.8rem; white-space:nowrap; }
.speed-fast   { color:#4ade80; }
.speed-medium { color:#fbbf24; }
.speed-slow   { color:#94a3b8; }

html:not(.dark) .speed-fast   { color:#16a34a }
html:not(.dark) .speed-medium { color:#d97706 }
html:not(.dark) .speed-slow   { color:#64748b }

/* ── Occupancy bar ──────────────────────────────────────────────────── */
.occ-bar-wrap { width:72px; height:6px; background:rgba(148,163,184,.15); border-radius:3px; overflow:hidden; }
html:not(.dark) .occ-bar-wrap { background:rgba(148,163,184,.25); }
.occ-bar  { height:100%; border-radius:3px; transition:width .5s ease; }
.occ-low  { background:#22c55e; }
.occ-mid  { background:#f59e0b; }
.occ-high { background:#ef4444; }

/* ── Pax cell ───────────────────────────────────────────────────────── */
.pax-cell { font-variant-numeric:tabular-nums; font-size:.78rem; color:#94a3b8; white-space:nowrap; }
html:not(.dark) .pax-cell { color:#64748b; }

/* ── Table body rows ────────────────────────────────────────────────── */
tbody td {
  padding: .6rem 1rem;
  font-size: .84rem;
  white-space: nowrap;
  border-bottom: 1px solid rgba(148,163,184,.08);
}
html:not(.dark) tbody td { border-bottom-color: rgba(148,163,184,.12); }
tbody tr:last-child td   { border-bottom: none; }
tbody tr { transition: background .1s; cursor: pointer; }
tbody tr:hover td  { background: rgba(148,163,184,.05); }
html:not(.dark) tbody tr:hover td { background: rgba(148,163,184,.07); }
tbody tr.selected td { background: rgba(59,130,246,.07) !important; }

.td-name { font-weight:600; color:#e2e8f0; max-width:190px; overflow:hidden; text-overflow:ellipsis; }
html:not(.dark) .td-name { color:#1e293b; }
.td-secondary { color:#94a3b8; max-width:150px; overflow:hidden; text-overflow:ellipsis; }
html:not(.dark) .td-secondary { color:#64748b; }

.empty-cell { padding:4rem 1rem; text-align:center; color:#94a3b8; font-style:italic; }
html:not(.dark) .empty-cell { color:#64748b; }

/* ── Column header filter active state ─────────────────────────────── */
thead th.filtered { color:#60a5fa !important; background:rgba(59,130,246,.07) !important; }
html:not(.dark) thead th.filtered { color:#2563eb !important; background:rgba(59,130,246,.06) !important; }

/* ── Detail panel grid ──────────────────────────────────────────────── */
.dp-grid {
  display: grid;
  grid-template-columns: auto 1fr;
  gap: .45rem .75rem;
  font-size: .82rem;
}
.dp-key      { color:#94a3b8; white-space:nowrap; }
.dp-value    { color:#e2e8f0; font-weight:500; word-break:break-word; text-align:right; }
.dp-divider  { grid-column:1/-1; border-top:1px solid rgba(148,163,184,.1); margin:.2rem 0; }

html:not(.dark) .dp-key     { color:#64748b; }
html:not(.dark) .dp-value   { color:#1e293b; }
html:not(.dark) .dp-divider { border-top-color:rgba(148,163,184,.18); }

/* ── Responsive: hide occupancy columns on mobile ───────────────────── */
@media (max-width:768px) {
  th:nth-child(8), td:nth-child(8),
  th:nth-child(9), td:nth-child(9) { display:none; }
}
